import{s as m,b as x,e as b,o as v,f as t,p as P,k as N,v as D,i as F,F as q,h as B,t as a,l as z,x as S,y as E,A as R}from"./vendor-CDgTUOzk.js";import{S as U}from"./SectionCard-Emg7MEbk.js";import{s as p}from"./index-DuACpEyu.js";const Z={class:"row g-3"},j={class:"col-12"},G={class:"d-flex gap-2"},H={class:"table-wrapper"},J={class:"table table-sm align-middle"},K={class:"fw-medium"},O={class:"text-capitalize"},Q={class:"text-end"},W={class:"text-end"},X={class:"btn-group btn-group-sm"},Y=["onClick"],tt=["onClick"],et={key:0},st={class:"table-footer"},ot={class:"small text-muted"},nt={class:"btn-group btn-group-sm"},lt=["disabled"],at=["disabled"],y=10,ct={__name:"InvoicesList",setup(ut){const f=D(),_=m(""),r=m(!0),d=m("all"),u=m(1);function V(n){return n.items.reduce((s,o)=>{const l=(Number(o.qty)||0)*(Number(o.unitPrice)||0),i=o.discountType||"none",c=Number(o.discountValue)||0,T=i==="percent"?l*c/100:i==="fixed"?(Number(o.qty)||0)*c:0,w=Math.max(0,l-T),A=(()=>{const k=p.taxes.find(L=>L.id===o.taxId);return k?w*(Number(k.rate)||0)/100:0})();return s+w+A},0)+Number(n.shippingFee||0)}const C=x(()=>{const n=_.value.trim().toLowerCase();let e=p.invoices.slice();return d.value!=="all"&&(e=e.filter(s=>(s.status||"draft")===d.value)),n&&(e=e.filter(s=>{var o,l,i;return((o=s.number)==null?void 0:o.toLowerCase().includes(n))||((i=(l=p.customers.find(c=>c.id===s.customerId))==null?void 0:l.name)==null?void 0:i.toLowerCase().includes(n))})),e.sort((s,o)=>r.value?(s.number||"").localeCompare(o.number||""):(o.number||"").localeCompare(s.number||"")),e}),h=x(()=>Math.max(1,Math.ceil(C.value.length/y))),g=x(()=>{const e=(Math.min(u.value,h.value)-1)*y;return C.value.slice(e,e+y)});function $(){f.push("/invoices/new")}function I(n){f.push(`/invoices/${n.id}`)}function M(n){f.push(`/invoices/${n.id}/edit`)}return(n,e)=>(v(),b("div",Z,[t("div",j,[P(U,{title:"Invoices"},{actions:N(()=>[t("div",G,[S(t("input",{class:"form-control form-control-sm",placeholder:"Search by number or customer...","onUpdate:modelValue":e[0]||(e[0]=s=>_.value=s)},null,512),[[E,_.value]]),S(t("select",{class:"form-select form-select-sm",style:{"max-width":"140px"},"onUpdate:modelValue":e[1]||(e[1]=s=>d.value=s)},[...e[5]||(e[5]=[t("option",{value:"all"},"All",-1),t("option",{value:"draft"},"Draft",-1),t("option",{value:"sent"},"Sent",-1),t("option",{value:"paid"},"Paid",-1),t("option",{value:"void"},"Void",-1)])],512),[[R,d.value]]),t("button",{class:"btn btn-sm btn-outline-secondary",type:"button",onClick:e[2]||(e[2]=s=>r.value=!r.value)},"Sort "+a(r.value?"A→Z":"Z→A"),1),t("button",{class:"btn btn-sm btn-primary",type:"button",onClick:$},"Create")])]),default:N(()=>[t("div",H,[t("table",J,[e[7]||(e[7]=t("thead",null,[t("tr",null,[t("th",null,"No"),t("th",null,"Date"),t("th",null,"Customer"),t("th",null,"Status"),t("th",{class:"text-end"},"Total (৳)"),t("th",{class:"text-end"})])],-1)),t("tbody",null,[(v(!0),b(q,null,B(g.value,s=>{var o;return v(),b("tr",{key:s.id},[t("td",K,a(s.number),1),t("td",null,a(s.date),1),t("td",null,a((o=z(p).customers.find(l=>l.id===s.customerId))==null?void 0:o.name),1),t("td",O,a(s.status||"draft"),1),t("td",Q,a(V(s).toFixed(2)),1),t("td",W,[t("div",X,[t("button",{class:"btn btn-outline-secondary",onClick:l=>I(s)},"View",8,Y),t("button",{class:"btn btn-outline-secondary",onClick:l=>M(s)},"Edit",8,tt)])])])}),128)),g.value.length===0?(v(),b("tr",et,[...e[6]||(e[6]=[t("td",{colspan:"6",class:"text-muted"},"No invoices found.",-1)])])):F("",!0)])])]),t("div",st,[t("div",ot,"Page "+a(u.value)+" of "+a(h.value),1),t("div",nt,[t("button",{class:"btn btn-outline-secondary",disabled:u.value<=1,onClick:e[3]||(e[3]=s=>u.value--)},"Prev",8,lt),t("button",{class:"btn btn-outline-secondary",disabled:u.value>=h.value,onClick:e[4]||(e[4]=s=>u.value++)},"Next",8,at)])])]),_:1})])]))}};export{ct as default};
