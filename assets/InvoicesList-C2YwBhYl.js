import{r,d as f,s as d,c,o as m,a as t,b as A,w as k,e as D,f as F,F as q,g as B,t as l,u as z,h as S,v as E,m as R}from"./index-DREjU6--.js";import{S as U}from"./SectionCard-X4BHsCon.js";const Z={class:"row g-3"},j={class:"col-12"},G={class:"d-flex gap-2"},H={class:"table-wrapper"},J={class:"table table-sm align-middle"},K={class:"fw-medium"},O={class:"text-capitalize"},Q={class:"text-end"},W={class:"text-end"},X={class:"btn-group btn-group-sm"},Y=["onClick"],tt=["onClick"],et={key:0},st={class:"table-footer"},ot={class:"small text-muted"},nt={class:"btn-group btn-group-sm"},lt=["disabled"],at=["disabled"],_=10,dt={__name:"InvoicesList",setup(ut){const b=D(),v=r(""),u=r(!0),i=r("all"),a=r(1);function V(n){return n.items.reduce((s,o)=>{const g=(Number(o.qty)||0)*(Number(o.unitPrice)||0),y=o.discountType||"none",C=Number(o.discountValue)||0,T=y==="percent"?g*C/100:y==="fixed"?(Number(o.qty)||0)*C:0,w=Math.max(0,g-T),L=(()=>{const N=d.taxes.find(P=>P.id===o.taxId);return N?w*(Number(N.rate)||0)/100:0})();return s+w+L},0)+Number(n.shippingFee||0)}const h=f(()=>{const n=v.value.trim().toLowerCase();let e=d.invoices.slice();return i.value!=="all"&&(e=e.filter(s=>(s.status||"draft")===i.value)),n&&(e=e.filter(s=>s.number?.toLowerCase().includes(n)||d.customers.find(o=>o.id===s.customerId)?.name?.toLowerCase().includes(n))),e.sort((s,o)=>u.value?(s.number||"").localeCompare(o.number||""):(o.number||"").localeCompare(s.number||"")),e}),p=f(()=>Math.max(1,Math.ceil(h.value.length/_))),x=f(()=>{const e=(Math.min(a.value,p.value)-1)*_;return h.value.slice(e,e+_)});function $(){b.push("/invoices/new")}function I(n){b.push(`/invoices/${n.id}`)}function M(n){b.push(`/invoices/${n.id}/edit`)}return(n,e)=>(m(),c("div",Z,[t("div",j,[A(U,{title:"Invoices"},{actions:k(()=>[t("div",G,[S(t("input",{class:"form-control form-control-sm",placeholder:"Search by number or customer...","onUpdate:modelValue":e[0]||(e[0]=s=>v.value=s)},null,512),[[E,v.value]]),S(t("select",{class:"form-select form-select-sm",style:{"max-width":"140px"},"onUpdate:modelValue":e[1]||(e[1]=s=>i.value=s)},[...e[5]||(e[5]=[t("option",{value:"all"},"All",-1),t("option",{value:"draft"},"Draft",-1),t("option",{value:"sent"},"Sent",-1),t("option",{value:"paid"},"Paid",-1),t("option",{value:"void"},"Void",-1)])],512),[[R,i.value]]),t("button",{class:"btn btn-sm btn-outline-secondary",type:"button",onClick:e[2]||(e[2]=s=>u.value=!u.value)},"Sort "+l(u.value?"A→Z":"Z→A"),1),t("button",{class:"btn btn-sm btn-primary",type:"button",onClick:$},"Create")])]),default:k(()=>[t("div",H,[t("table",J,[e[7]||(e[7]=t("thead",null,[t("tr",null,[t("th",null,"No"),t("th",null,"Date"),t("th",null,"Customer"),t("th",null,"Status"),t("th",{class:"text-end"},"Total (৳)"),t("th",{class:"text-end"})])],-1)),t("tbody",null,[(m(!0),c(q,null,B(x.value,s=>(m(),c("tr",{key:s.id},[t("td",K,l(s.number),1),t("td",null,l(s.date),1),t("td",null,l(z(d).customers.find(o=>o.id===s.customerId)?.name),1),t("td",O,l(s.status||"draft"),1),t("td",Q,l(V(s).toFixed(2)),1),t("td",W,[t("div",X,[t("button",{class:"btn btn-outline-secondary",onClick:o=>I(s)},"View",8,Y),t("button",{class:"btn btn-outline-secondary",onClick:o=>M(s)},"Edit",8,tt)])])]))),128)),x.value.length===0?(m(),c("tr",et,[...e[6]||(e[6]=[t("td",{colspan:"6",class:"text-muted"},"No invoices found.",-1)])])):F("",!0)])])]),t("div",st,[t("div",ot,"Page "+l(a.value)+" of "+l(p.value),1),t("div",nt,[t("button",{class:"btn btn-outline-secondary",disabled:a.value<=1,onClick:e[3]||(e[3]=s=>a.value--)},"Prev",8,lt),t("button",{class:"btn btn-outline-secondary",disabled:a.value>=p.value,onClick:e[4]||(e[4]=s=>a.value++)},"Next",8,at)])])]),_:1})])]))}};export{dt as default};
