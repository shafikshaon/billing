import{u as T,s as U,r as w,z as O,d as u,o as m,e,p as S,l as D,x as l,y as r,A as d,F as A,g as N,t as k,m as P}from"./vendor-CJczNIjx.js";import{S as M}from"./SectionCard-C9PBNAnP.js";import{u as p,s as V,a as C,b as I}from"./index-CYiN_h_V.js";const L={class:"row g-3 justify-content-center"},_={class:"col-12 col-lg-8 col-xl-7"},q={class:"row g-3"},Y={class:"col-md-7"},B={class:"col-md-5"},G={class:"col-12"},J={class:"col-12"},$={class:"table-responsive"},j={class:"table table-sm align-middle"},R=["onUpdate:modelValue"],W=["onUpdate:modelValue"],z=["onUpdate:modelValue"],H=["onUpdate:modelValue"],K=["onUpdate:modelValue"],Q=["onUpdate:modelValue"],X={class:"text-end"},Z=["onClick"],ee={class:"col-12"},te={class:"row g-2"},se={class:"col-md-4"},oe={class:"col-md-4"},le={class:"col-md-4"},ne={class:"col-md-4"},ae={class:"col-md-4"},re={class:"col-md-4"},ie={class:"col-md-4"},de={class:"col-md-4"},ue={class:"col-md-4"},ye={__name:"PaymentTermForm",setup(me){const f=T(),y=U(),i=I(),c=f.path.endsWith("/edit"),b=c?f.params.id:null,o=w({id:"",name:"",description:"",active:!0,sequence:0,settings:{earlyDiscountEnabled:!1,earlyDiscountPercent:0,earlyDiscountDays:0,showInstallmentDates:!0,showOnInvoice:!0,lateFeeEnabled:!1,lateFeeType:"percent",lateFeeAmount:0,lateFeeGraceDays:0},schedule:[{id:p("ptl_"),sequence:1,valueType:"percent",valueAmount:100,dateType:"days_after",days:0,dayOfMonth:null,description:"Due on receipt"}]});O(()=>{if(c&&b){const a=V.paymentTerms.find(t=>t.id===b);a&&Object.assign(o,JSON.parse(JSON.stringify(a)))}});function h(){o.schedule.push({id:p("ptl_"),sequence:o.schedule.length+1,valueType:"percent",valueAmount:50,dateType:"days_after",days:30,dayOfMonth:null,description:""})}function x(a){o.schedule.splice(a,1),o.schedule.forEach((t,s)=>t.sequence=s+1)}function E(){var a;if(!((a=o.name)!=null&&a.trim()))return i.error("Validation Error","Payment term name is required"),!1;if(!o.schedule||o.schedule.length===0)return i.error("Validation Error","At least one schedule line is required"),!1;for(let t=0;t<o.schedule.length;t++){const s=o.schedule[t];if(s.valueAmount<=0)return i.error("Validation Error",`Schedule line ${t+1}: Value amount must be greater than 0`),!1;if(s.dateType==="days_after"&&s.days<0)return i.error("Validation Error",`Schedule line ${t+1}: Days cannot be negative`),!1;if(s.dateType==="day_of_month"&&(s.dayOfMonth<1||s.dayOfMonth>31))return i.error("Validation Error",`Schedule line ${t+1}: Day of month must be between 1 and 31`),!1}if(o.settings.earlyDiscountEnabled){if(o.settings.earlyDiscountPercent<0||o.settings.earlyDiscountPercent>100)return i.error("Validation Error","Early discount percent must be between 0 and 100"),!1;if(o.settings.earlyDiscountDays<0)return i.error("Validation Error","Early discount days cannot be negative"),!1}return o.settings.lateFeeEnabled&&o.settings.lateFeeAmount<0?(i.error("Validation Error","Late fee amount cannot be negative"),!1):!0}function v(){y.push("/payment-terms")}function F(){if(!E())return;o.id||(o.id=p("term_"));const a=JSON.parse(JSON.stringify(o));C(V.paymentTerms,a),i.success("Saved","Payment term saved successfully"),y.push("/payment-terms")}return(a,t)=>(m(),u("div",L,[e("div",_,[S(M,{title:P(c)?"Edit Payment Term":"New Payment Term"},{actions:D(()=>[e("button",{class:"btn btn-sm btn-outline-secondary",type:"button",onClick:v},"Back to list")]),default:D(()=>[e("div",q,[e("div",Y,[t[12]||(t[12]=e("label",{class:"form-label"},"Name",-1)),l(e("input",{class:"form-control form-control-sm","onUpdate:modelValue":t[0]||(t[0]=s=>o.name=s),placeholder:"e.g., 2/10 Net 30 or 50/50 in 30d"},null,512),[[r,o.name]])]),e("div",B,[t[14]||(t[14]=e("label",{class:"form-label"},"Active",-1)),l(e("select",{class:"form-select form-select-sm","onUpdate:modelValue":t[1]||(t[1]=s=>o.active=s)},[...t[13]||(t[13]=[e("option",{value:!0},"Yes",-1),e("option",{value:!1},"No",-1)])],512),[[d,o.active]])]),e("div",G,[t[15]||(t[15]=e("label",{class:"form-label"},"Description",-1)),l(e("textarea",{class:"form-control",rows:"2","onUpdate:modelValue":t[2]||(t[2]=s=>o.description=s),placeholder:"Optional description"},null,512),[[r,o.description]])]),e("div",J,[t[19]||(t[19]=e("h6",{class:"text-secondary mb-1"},"Schedule",-1)),e("div",$,[e("table",j,[t[18]||(t[18]=e("thead",{class:"table-light"},[e("tr",null,[e("th",{style:{width:"10%"}},"#"),e("th",{style:{width:"18%"}},"Value Type"),e("th",{style:{width:"16%"}},"Value"),e("th",{style:{width:"20%"}},"Date Type"),e("th",{style:{width:"16%"}},"Days / Day"),e("th",null,"Description"),e("th",{class:"text-end",style:{width:"8%"}})])],-1)),e("tbody",null,[(m(!0),u(A,null,N(o.schedule,(s,g)=>(m(),u("tr",{key:s.id},[e("td",null,k(g+1),1),e("td",null,[l(e("select",{class:"form-select form-select-sm","onUpdate:modelValue":n=>s.valueType=n},[...t[16]||(t[16]=[e("option",{value:"percent"},"Percent",-1),e("option",{value:"fixed"},"Fixed Amount",-1)])],8,R),[[d,s.valueType]])]),e("td",null,[l(e("input",{class:"form-control form-control-sm text-end",type:"number",min:"0",step:"0.01","onUpdate:modelValue":n=>s.valueAmount=n},null,8,W),[[r,s.valueAmount,void 0,{number:!0}]])]),e("td",null,[l(e("select",{class:"form-select form-select-sm","onUpdate:modelValue":n=>s.dateType=n},[...t[17]||(t[17]=[e("option",{value:"days_after"},"Days After",-1),e("option",{value:"day_of_month"},"Day of Month (next)",-1)])],8,z),[[d,s.dateType]])]),e("td",null,[s.dateType==="days_after"?l((m(),u("input",{key:0,class:"form-control form-control-sm text-end",type:"number",min:"0",step:"1","onUpdate:modelValue":n=>s.days=n},null,8,H)),[[r,s.days,void 0,{number:!0}]]):l((m(),u("input",{key:1,class:"form-control form-control-sm text-end",type:"number",min:"1",max:"31",step:"1","onUpdate:modelValue":n=>s.dayOfMonth=n},null,8,K)),[[r,s.dayOfMonth,void 0,{number:!0}]])]),e("td",null,[l(e("input",{class:"form-control form-control-sm","onUpdate:modelValue":n=>s.description=n,placeholder:"Optional"},null,8,Q),[[r,s.description]])]),e("td",X,[e("button",{class:"btn btn-sm btn-outline-danger",type:"button",onClick:n=>x(g)},"Remove",8,Z)])]))),128))])])]),e("button",{class:"btn btn-sm btn-outline-secondary",type:"button",onClick:h},"+ Add line")]),e("div",ee,[t[34]||(t[34]=e("h6",{class:"text-secondary mb-1"},"Options",-1)),e("div",te,[e("div",se,[t[21]||(t[21]=e("label",{class:"form-label"},"Early Discount?",-1)),l(e("select",{class:"form-select form-select-sm","onUpdate:modelValue":t[3]||(t[3]=s=>o.settings.earlyDiscountEnabled=s)},[...t[20]||(t[20]=[e("option",{value:!0},"Yes",-1),e("option",{value:!1},"No",-1)])],512),[[d,o.settings.earlyDiscountEnabled]])]),e("div",oe,[t[22]||(t[22]=e("label",{class:"form-label"},"Discount %",-1)),l(e("input",{class:"form-control form-control-sm text-end",type:"number",min:"0",step:"0.01","onUpdate:modelValue":t[4]||(t[4]=s=>o.settings.earlyDiscountPercent=s)},null,512),[[r,o.settings.earlyDiscountPercent,void 0,{number:!0}]])]),e("div",le,[t[23]||(t[23]=e("label",{class:"form-label"},"Within (days)",-1)),l(e("input",{class:"form-control form-control-sm text-end",type:"number",min:"0",step:"1","onUpdate:modelValue":t[5]||(t[5]=s=>o.settings.earlyDiscountDays=s)},null,512),[[r,o.settings.earlyDiscountDays,void 0,{number:!0}]])]),e("div",ne,[t[25]||(t[25]=e("label",{class:"form-label"},"Show Schedule Dates",-1)),l(e("select",{class:"form-select form-select-sm","onUpdate:modelValue":t[6]||(t[6]=s=>o.settings.showInstallmentDates=s)},[...t[24]||(t[24]=[e("option",{value:!0},"Yes",-1),e("option",{value:!1},"No",-1)])],512),[[d,o.settings.showInstallmentDates]])]),e("div",ae,[t[27]||(t[27]=e("label",{class:"form-label"},"Show on Invoice",-1)),l(e("select",{class:"form-select form-select-sm","onUpdate:modelValue":t[7]||(t[7]=s=>o.settings.showOnInvoice=s)},[...t[26]||(t[26]=[e("option",{value:!0},"Yes",-1),e("option",{value:!1},"No",-1)])],512),[[d,o.settings.showOnInvoice]])]),e("div",re,[t[29]||(t[29]=e("label",{class:"form-label"},"Late Fee Enabled",-1)),l(e("select",{class:"form-select form-select-sm","onUpdate:modelValue":t[8]||(t[8]=s=>o.settings.lateFeeEnabled=s)},[...t[28]||(t[28]=[e("option",{value:!0},"Yes",-1),e("option",{value:!1},"No",-1)])],512),[[d,o.settings.lateFeeEnabled]])]),e("div",ie,[t[31]||(t[31]=e("label",{class:"form-label"},"Late Fee Type",-1)),l(e("select",{class:"form-select form-select-sm","onUpdate:modelValue":t[9]||(t[9]=s=>o.settings.lateFeeType=s)},[...t[30]||(t[30]=[e("option",{value:"percent"},"Percent",-1),e("option",{value:"fixed"},"Fixed",-1)])],512),[[d,o.settings.lateFeeType]])]),e("div",de,[t[32]||(t[32]=e("label",{class:"form-label"},"Late Fee Amount",-1)),l(e("input",{class:"form-control form-control-sm text-end",type:"number",min:"0",step:"0.01","onUpdate:modelValue":t[10]||(t[10]=s=>o.settings.lateFeeAmount=s)},null,512),[[r,o.settings.lateFeeAmount,void 0,{number:!0}]])]),e("div",ue,[t[33]||(t[33]=e("label",{class:"form-label"},"Late Fee Grace (days)",-1)),l(e("input",{class:"form-control form-control-sm text-end",type:"number",min:"0",step:"1","onUpdate:modelValue":t[11]||(t[11]=s=>o.settings.lateFeeGraceDays=s)},null,512),[[r,o.settings.lateFeeGraceDays,void 0,{number:!0}]])])])])]),e("div",{class:"d-flex justify-content-end gap-2 mt-2"},[e("button",{class:"btn btn-outline-secondary",type:"button",onClick:v},"Cancel"),e("button",{class:"btn btn-primary",type:"button",onClick:F},"Save")])]),_:1},8,["title"])])]))}};export{ye as default};
